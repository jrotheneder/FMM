(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     78684,       1809]
NotebookOptionsPosition[     72486,       1710]
NotebookOutlinePosition[     73168,       1733]
CellTagsIndexPosition[     73125,       1730]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["FMM Seq. Test & Orthtree Visualization", "Title",
 CellChangeTimes->{{3.765306072713745*^9, 3.7653060835077667`*^9}, {
   3.765975133696273*^9, 3.765975134103532*^9}, 3.7661729732629232`*^9},
 TextAlignment->Center,ExpressionUUID->"20b3e9fa-13ef-437a-8ffb-39c21866f0df"],

Cell[BoxData[{
 RowBox[{"<<", " ", "Utility`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", " ", "MaTeX`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", "NBD", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "x_", "]"}], ":=", 
   SqrtBox[
    RowBox[{"x", ".", "x"}]]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeBoxPoints", "[", 
    RowBox[{"center_", ",", " ", "box\[LetterSpace]len_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diagonal", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "center", "]"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"center", " ", "-", " ", 
        RowBox[{
         FractionBox["box\[LetterSpace]len", "2"], "diagonal"}]}], ",", 
       RowBox[{"center", " ", "+", " ", 
        RowBox[{
         FractionBox["box\[LetterSpace]len", "2"], "diagonal"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeBox", "[", 
   RowBox[{"{", 
    RowBox[{"pt1_", ",", "pt2_"}], "}"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dim", " ", "=", " ", 
      RowBox[{"Length", "[", "pt1", "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", 
      RowBox[{"Rectangle", "[", 
       RowBox[{"pt1", ",", "pt2"}], "]"}], ",", 
      RowBox[{"Cuboid", "[", 
       RowBox[{"pt1", ",", "pt2"}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.765306193441283*^9, 3.7653062037009497`*^9}, {
   3.765312056691987*^9, 3.765312056873152*^9}, 3.765314656681868*^9, {
   3.765645234116963*^9, 3.76564532365963*^9}, {3.765645482476872*^9, 
   3.7656455125810757`*^9}, {3.765645588701152*^9, 3.7656456656271973`*^9}, {
   3.7656458119502087`*^9, 3.7656458668131123`*^9}, {3.7656460442268677`*^9, 
   3.76564607194392*^9}, {3.7656465558513527`*^9, 3.765646602050934*^9}, {
   3.765646638701717*^9, 3.76564664284324*^9}, {3.766238866178584*^9, 
   3.7662388738482723`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"a297ad90-e482-4d8d-ac2f-afc759f162cc"],

Cell[CellGroupData[{

Cell["Point Orthtree", "Subsection",
 CellChangeTimes->{{3.766006790370146*^9, 
  3.766006792321598*^9}},ExpressionUUID->"a0a974cb-ad02-4734-9d09-\
73199af7141c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"treeGeometryData", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<geometry.dat\>\"", ",", "\"\<Table\>\"", ",", 
     RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointsData", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<points.dat\>\"", ",", "\"\<Table\>\"", ",", 
     RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neighbourData", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<neighbours.dat\>\"", ",", "\"\<Table\>\"", ",", 
     RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interactionData", " ", "=", " ", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<interactions.dat\>\"", ",", "\"\<Table\>\"", ",", 
      RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim", " ", "=", "  ", 
   RowBox[{"Length", " ", "@", " ", 
    RowBox[{"treeGeometryData", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"4", ";;"}]}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"quadtreeNodes", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"center", " ", "=", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"4", ";;", 
              RowBox[{"4", "+", "dim", "-", "1"}]}], "]"}], "]"}]}], ",", 
          RowBox[{"box\[LetterSpace]len", " ", "=", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{"diag", " ", "=", " ", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", "dim"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"makeBoxPoints", "[", 
             RowBox[{"center", ",", "box\[LetterSpace]len"}], "]"}], ",", 
            "1"}], "]"}]}], " ", "]"}]}], "]"}], "&"}], "/@", " ", 
     "treeGeometryData"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"height", " ", "=", " ", 
    RowBox[{"Max", " ", "@", " ", 
     RowBox[{"quadtreeNodes", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"quadtreeNodesbyLevel", " ", "=", " ", 
   RowBox[{"GroupBy", "[", 
    RowBox[{"quadtreeNodes", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointsDataByNode", " ", "=", " ", 
   RowBox[{
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}], ",", "dim"}], "]"}]}], "&"}], "/@",
       " ", "pointsData"}], "]"}], " ", "//.", " ", 
    RowBox[{
     RowBox[{"{", "}"}], "\[Rule]", 
     RowBox[{"Sequence", "[", "]"}]}]}]}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.765306153826641*^9, 3.765306156166518*^9}, {
   3.765306189916923*^9, 3.765306192420001*^9}, {3.765306228443913*^9, 
   3.7653062365296507`*^9}, {3.765310359930539*^9, 3.765310373248488*^9}, {
   3.76531056810246*^9, 3.765310588148979*^9}, {3.765310654651972*^9, 
   3.765310666178987*^9}, {3.76531072093867*^9, 3.765310723858541*^9}, 
   3.7653128064957952`*^9, {3.7653146454122467`*^9, 3.765314659642091*^9}, 
   3.765465209130671*^9, {3.765548501441495*^9, 3.765548508314419*^9}, {
   3.765548588366755*^9, 3.7655485913270483`*^9}, 3.76554954508352*^9, {
   3.765560196170577*^9, 3.765560199703437*^9}, {3.765560351007453*^9, 
   3.765560403451131*^9}, {3.7655605232748213`*^9, 3.765560574863751*^9}, {
   3.765560612183036*^9, 3.765560647398563*^9}, {3.765560686453608*^9, 
   3.7655607024246197`*^9}, {3.7655607864084473`*^9, 3.765560788979247*^9}, {
   3.765560846973298*^9, 3.765560847835854*^9}, {3.765560919266876*^9, 
   3.765561004424477*^9}, {3.7655617295629168`*^9, 3.765561732264578*^9}, {
   3.7655623289450293`*^9, 3.765562333948988*^9}, {3.765644327010954*^9, 
   3.765644391456016*^9}, {3.765644429574974*^9, 3.76564450863934*^9}, {
   3.765644550692878*^9, 3.7656445828027678`*^9}, {3.765644652651855*^9, 
   3.765644665768009*^9}, {3.765645541261139*^9, 3.765645556980432*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"ead56676-13ad-4377-a2bc-d4bc6a788c08"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lpPoints", " ", "=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Values", "[", "pointsDataByNode", "]"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ListPointPlot3D", "[", 
       RowBox[{
        RowBox[{"Values", "[", "pointsDataByNode", "]"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subdivGraphicsFun", "[", "l_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"opts", " ", "=", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
         RowBox[{"Opacity", "[", "0", "]"}]}], "]"}]}], " ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", " ", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"opts", ",", 
           RowBox[{"Dynamic", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Rectangle", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ";;", 
                   RowBox[{"3", "+", "dim", "-", "1"}]}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"3", "+", "dim"}], ";;"}], "]"}], "]"}]}], "]"}], 
              "&"}], "/@", " ", 
             RowBox[{"quadtreeNodesbyLevel", "[", "l", "]"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", " ", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{"opts", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"Cuboid", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ";;", 
                  RowBox[{"3", "+", "dim", "-", "1"}]}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"3", "+", "dim"}], ";;"}], "]"}], "]"}]}], "]"}], 
             "]"}], "&"}], "/@", " ", 
           RowBox[{"quadtreeNodesbyLevel", "[", "l", "]"}]}]}], "}"}], 
        "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interactionGraphicFun", "[", "interactionDataPoint_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"level", " ", "=", " ", 
        RowBox[{"interactionDataPoint", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"box\[LetterSpace]len", " ", "=", " ", 
        RowBox[{"interactionDataPoint", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"center", " ", "=", " ", 
        RowBox[{"interactionDataPoint", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", 
           RowBox[{"4", "+", "dim", "-", "1"}]}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"assocPoints", " ", "=", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"interactionDataPoint", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"4", "+", "dim"}], ";;"}], "]"}], "]"}], ",", "dim"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"srcGraphicsOpts", " ", "=", " ", 
        RowBox[{"Directive", "[", 
         RowBox[{"Purple", ",", 
          RowBox[{"Opacity", "[", ".25", "]"}], ",", 
          RowBox[{"EdgeForm", "[", "Black", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"interactsGraphicsOpts", " ", "=", " ", 
        RowBox[{"Directive", "[", 
         RowBox[{"Orange", ",", 
          RowBox[{"Opacity", "[", "0.1", "]"}], ",", 
          RowBox[{"EdgeForm", "[", "Black", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"GraphicsFun", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", " ", "Graphics", 
          ",", " ", "Graphics3D"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
     ",", 
     RowBox[{"GraphicsFun", "@", " ", 
      RowBox[{"{", 
       RowBox[{"interactsGraphicsOpts", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"makeBox", "[", 
           RowBox[{"makeBoxPoints", "[", 
            RowBox[{"#", ",", "box\[LetterSpace]len"}], "]"}], "]"}], "&"}], "/@",
          " ", "assocPoints"}], ",", "srcGraphicsOpts", ",", 
        RowBox[{"makeBox", "[", 
         RowBox[{"makeBoxPoints", "[", 
          RowBox[{"center", ",", " ", "box\[LetterSpace]len"}], "]"}], 
         "]"}]}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", 
     StyleBox["[", "Input"], 
     StyleBox[
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"lpPoints", ",", "\[IndentingNewLine]", 
        RowBox[{"subdivGraphicsFun", "[", "l", "]"}]}], "\[IndentingNewLine]",
        "}"}], "Input"], 
     StyleBox["]", "Input"]}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "0", ",", "height", ",", "1"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"subdivGraphicsFun", "[", 
          RowBox[{"interactionData", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"interactionGraphicFun", " ", "@", " ", 
          RowBox[{"neighbourData", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"subdivGraphicsFun", "[", 
          RowBox[{"interactionData", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"interactionGraphicFun", " ", "@", " ", 
          RowBox[{"interactionData", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "neighbourData", "]"}], ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.765312882589204*^9, 3.765313035570677*^9}, {
   3.765313266259618*^9, 3.765313266362226*^9}, {3.765313298028767*^9, 
   3.7653133097664537`*^9}, {3.765313823102285*^9, 3.765313832375024*^9}, {
   3.76531427666072*^9, 3.765314276798758*^9}, {3.7653143284714317`*^9, 
   3.765314328612067*^9}, {3.76546513034007*^9, 3.7654651656248503`*^9}, {
   3.7654654073839817`*^9, 3.7654654556267223`*^9}, {3.7655475570559177`*^9, 
   3.765547557109421*^9}, {3.765547590511417*^9, 3.7655475906691217`*^9}, {
   3.765547721867256*^9, 3.7655477230988083`*^9}, {3.765547785683567*^9, 
   3.7655477857288*^9}, {3.765548118557727*^9, 3.765548118697876*^9}, {
   3.765549647886285*^9, 3.765549651355523*^9}, {3.7655498440503902`*^9, 
   3.7655498447836742`*^9}, {3.7655504806897287`*^9, 3.765550483132427*^9}, {
   3.76555102921898*^9, 3.765551030236555*^9}, {3.765551447802456*^9, 
   3.765551469368621*^9}, {3.765551635278389*^9, 3.7655516360141287`*^9}, {
   3.765551669570581*^9, 3.765551675450844*^9}, {3.765551722780493*^9, 
   3.765551732269063*^9}, {3.765561215773588*^9, 3.7655613337763853`*^9}, {
   3.765561367577497*^9, 3.7655613734477253`*^9}, {3.765561487817129*^9, 
   3.765561488896133*^9}, {3.7655615611835957`*^9, 3.765561605827853*^9}, {
   3.765561737250759*^9, 3.765561786175887*^9}, {3.765562348743559*^9, 
   3.7655623511428833`*^9}, {3.765644508643427*^9, 3.765644508645266*^9}, {
   3.765644672161911*^9, 3.7656447363990517`*^9}, {3.7656466476249123`*^9, 
   3.765646682743989*^9}, {3.765646780424035*^9, 3.765646783021538*^9}, {
   3.765647314606834*^9, 3.765647314906753*^9}, {3.76565243861965*^9, 
   3.765652438847023*^9}, 3.7656525219681664`*^9, {3.765652587470716*^9, 
   3.7656526015938253`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"d3a5136f-f884-468d-a6ea-0fda3d884643"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`l$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`l$$], 0, 3, 1}}, Typeset`size$$ = {295., {4., 10.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`l$2907$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`l$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`l$$, $CellContext`l$2907$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[{$CellContext`lpPoints, 
         $CellContext`subdivGraphicsFun[$CellContext`l$$]}], 
      "Specifications" :> {{$CellContext`l$$, 0, 3, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{338., {48., 53.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.765312911092852*^9, 3.765313036023178*^9}, 
   3.765313266627288*^9, 3.7653138328675413`*^9, 3.765314127652234*^9, 
   3.765314215037654*^9, 3.7653142773467417`*^9, 3.7653143289895906`*^9, 
   3.76531445141324*^9, {3.7653146615149097`*^9, 3.7653146699703913`*^9}, {
   3.765361557661113*^9, 3.7653615753215218`*^9}, {3.7654651085084047`*^9, 
   3.765465166340571*^9}, {3.765465398818254*^9, 3.7654654156189213`*^9}, 
   3.765465456150857*^9, {3.7654864620707407`*^9, 3.765486467329773*^9}, {
   3.765547258287045*^9, 3.7655472640776443`*^9}, {3.765547505090053*^9, 
   3.765547591612275*^9}, {3.765547724103897*^9, 3.765547734203333*^9}, {
   3.76554778656467*^9, 3.765547810608712*^9}, 3.765548076732621*^9, 
   3.7655481195036182`*^9, 3.765548301244248*^9, 3.7655487697494993`*^9, 
   3.765548876254799*^9, 3.76554956385641*^9, 3.765549652059251*^9, 
   3.765549845393401*^9, 3.765550483880498*^9, 3.765550657098749*^9, 
   3.76555086621697*^9, 3.7655510307844887`*^9, 3.765551471053134*^9, 
   3.7655516761489897`*^9, {3.7655517330808687`*^9, 3.765551745641128*^9}, {
   3.7655543890548277`*^9, 3.7655544067150784`*^9}, 3.765561289566967*^9, 
   3.765561335588121*^9, 3.765561373825232*^9, {3.765561580100933*^9, 
   3.765561606264292*^9}, 3.7655616460335827`*^9, {3.7655617425220633`*^9, 
   3.765561786838826*^9}, 3.76556183889212*^9, {3.765562338962289*^9, 
   3.7655623554353848`*^9}, {3.765562404090213*^9, 3.765562414607958*^9}, 
   3.765562462464918*^9, {3.7656402968818398`*^9, 3.765640306864003*^9}, {
   3.765640392220315*^9, 3.765640404346279*^9}, {3.765644484660678*^9, 
   3.7656445146289663`*^9}, 3.765644694574778*^9, 3.765645560706962*^9, 
   3.7656466844292183`*^9, 3.7656467835188923`*^9, 3.765647315586472*^9, 
   3.7656493988339453`*^9, {3.765652440900283*^9, 3.765652470130382*^9}, 
   3.765652522718858*^9, {3.7656525883434*^9, 3.76565260246799*^9}, {
   3.7659751440746727`*^9, 3.7659751481817207`*^9}, {3.765994471354288*^9, 
   3.765994477168778*^9}},
 CellLabel->"Out[23]=",ExpressionUUID->"75bf61fc-35d7-4fed-af2c-f5a1bc1acab2"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 19, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 85, 1}}, Typeset`size$$ = {324., {83., 86.}},
     Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`i$2947$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$2947$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> GraphicsRow[{
         Show[{
           $CellContext`subdivGraphicsFun[
            Part[$CellContext`interactionData, $CellContext`i$$, 2]], 
           $CellContext`interactionGraphicFun[
            Part[$CellContext`neighbourData, $CellContext`i$$]]}], 
         Show[{
           $CellContext`subdivGraphicsFun[
            Part[$CellContext`interactionData, $CellContext`i$$, 2]], 
           $CellContext`interactionGraphicFun[
            Part[$CellContext`interactionData, $CellContext`i$$]]}]}], 
      "Specifications" :> {{$CellContext`i$$, 1, 85, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{367., {124., 129.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.765312911092852*^9, 3.765313036023178*^9}, 
   3.765313266627288*^9, 3.7653138328675413`*^9, 3.765314127652234*^9, 
   3.765314215037654*^9, 3.7653142773467417`*^9, 3.7653143289895906`*^9, 
   3.76531445141324*^9, {3.7653146615149097`*^9, 3.7653146699703913`*^9}, {
   3.765361557661113*^9, 3.7653615753215218`*^9}, {3.7654651085084047`*^9, 
   3.765465166340571*^9}, {3.765465398818254*^9, 3.7654654156189213`*^9}, 
   3.765465456150857*^9, {3.7654864620707407`*^9, 3.765486467329773*^9}, {
   3.765547258287045*^9, 3.7655472640776443`*^9}, {3.765547505090053*^9, 
   3.765547591612275*^9}, {3.765547724103897*^9, 3.765547734203333*^9}, {
   3.76554778656467*^9, 3.765547810608712*^9}, 3.765548076732621*^9, 
   3.7655481195036182`*^9, 3.765548301244248*^9, 3.7655487697494993`*^9, 
   3.765548876254799*^9, 3.76554956385641*^9, 3.765549652059251*^9, 
   3.765549845393401*^9, 3.765550483880498*^9, 3.765550657098749*^9, 
   3.76555086621697*^9, 3.7655510307844887`*^9, 3.765551471053134*^9, 
   3.7655516761489897`*^9, {3.7655517330808687`*^9, 3.765551745641128*^9}, {
   3.7655543890548277`*^9, 3.7655544067150784`*^9}, 3.765561289566967*^9, 
   3.765561335588121*^9, 3.765561373825232*^9, {3.765561580100933*^9, 
   3.765561606264292*^9}, 3.7655616460335827`*^9, {3.7655617425220633`*^9, 
   3.765561786838826*^9}, 3.76556183889212*^9, {3.765562338962289*^9, 
   3.7655623554353848`*^9}, {3.765562404090213*^9, 3.765562414607958*^9}, 
   3.765562462464918*^9, {3.7656402968818398`*^9, 3.765640306864003*^9}, {
   3.765640392220315*^9, 3.765640404346279*^9}, {3.765644484660678*^9, 
   3.7656445146289663`*^9}, 3.765644694574778*^9, 3.765645560706962*^9, 
   3.7656466844292183`*^9, 3.7656467835188923`*^9, 3.765647315586472*^9, 
   3.7656493988339453`*^9, {3.765652440900283*^9, 3.765652470130382*^9}, 
   3.765652522718858*^9, {3.7656525883434*^9, 3.76565260246799*^9}, {
   3.7659751440746727`*^9, 3.7659751481817207`*^9}, {3.765994471698883*^9, 
   3.7659944848534718`*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"d3f1e018-0dc6-440c-a444-4541a98421e1"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"lpPoints\\\", \\\",\\\", RowBox[{\\\"subdivGraphicsFun\\\", \\\"[\
\\\", \\\"3\\\", \\\"]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]\\).\"",2,1,1,
   21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766006787332097*^9},
 CellLabel->"",ExpressionUUID->"c65c59ac-3357-44f8-a1e2-6b42c6f75069"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"19\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,1,2,
   21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766006787455484*^9},
 CellLabel->"",ExpressionUUID->"2bd87da4-1ffb-405d-b1af-0e254ba2774e"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"neighbourData\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"19\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,1,3,21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7660067874776163`*^9},
 CellLabel->"",ExpressionUUID->"25c41130-3c14-4675-8c58-ed7b1e1923c9"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"subdivGraphicsFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"19\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"interactionGraphicFun\\\", \\\"[\\\", RowBox[{\\\"neighbourData\\\
\", \\\"\[LeftDoubleBracket]\\\", \\\"19\\\", \
\\\"\[RightDoubleBracket]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \
\\\"]\\\"}]\\).\"",2,1,4,21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766006787488493*^9},
 CellLabel->"",ExpressionUUID->"8d763562-3464-4bc3-a528-422b9763ea09"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"19\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,1,5,
   21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766006787544416*^9},
 CellLabel->"",ExpressionUUID->"dd3cb6f3-1947-49a0-907e-ce089a3e119d"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,1,6,21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7660067875935593`*^9},
 CellLabel->"",ExpressionUUID->"fdb8e406-dce0-4f5b-9add-84fb1f40f622"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"subdivGraphicsFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"19\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"interactionGraphicFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\
\\\", \\\"\[LeftDoubleBracket]\\\", \\\"19\\\", \
\\\"\[RightDoubleBracket]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \
\\\"]\\\"}]\\).\"",2,1,7,21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766006787645767*^9},
 CellLabel->"",ExpressionUUID->"6d5aeeac-f13a-44b0-9d0f-faeb80c48d90"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"19\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,1,8,
   21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766006789375828*^9},
 CellLabel->"",ExpressionUUID->"d97e07f9-f735-4a02-93c3-aeb3ec985580"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"neighbourData\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"19\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,1,9,21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766006789387615*^9},
 CellLabel->"",ExpressionUUID->"1a00d945-aa3f-4be4-9404-405dbacfea2c"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"subdivGraphicsFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"19\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"interactionGraphicFun\\\", \\\"[\\\", RowBox[{\\\"neighbourData\\\
\", \\\"\[LeftDoubleBracket]\\\", \\\"19\\\", \
\\\"\[RightDoubleBracket]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \
\\\"]\\\"}]\\).\"",2,1,10,21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766006789399768*^9},
 CellLabel->"",ExpressionUUID->"5bdf764b-f385-4852-b778-beb0f1cc69bc"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"19\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,1,11,
   21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766006789407205*^9},
 CellLabel->"",ExpressionUUID->"d19e8a11-3692-4dae-a7fb-4903ce061f76"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,1,12,21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7660067894624166`*^9},
 CellLabel->"",ExpressionUUID->"bd92b5ec-34b5-414c-9fed-cad7c14571c3"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"subdivGraphicsFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"19\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"interactionGraphicFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\
\\\", \\\"\[LeftDoubleBracket]\\\", \\\"19\\\", \
\\\"\[RightDoubleBracket]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \
\\\"]\\\"}]\\).\"",2,1,13,21404441041004675913,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766006789513483*^9},
 CellLabel->"",ExpressionUUID->"c4f32a25-cbfc-4123-adff-b19c454e6fa6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", " ", "@", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", " ", 
    RowBox[{"Values", "[", "pointsDataByNode", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nLeaves", " ", "=", " ", 
   RowBox[{"Length", " ", "@", " ", "pointsData"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"avgNPerLeaf", " ", "=", " ", 
  RowBox[{
   RowBox[{"n", "/", "nLeaves"}], " ", "//", "N"}]}]}], "Input",
 CellChangeTimes->{{3.765551787041687*^9, 3.765551890652936*^9}, {
  3.765561623404464*^9, 3.765561627787978*^9}, {3.765561724289393*^9, 
  3.7655617257193613`*^9}, {3.765640334375659*^9, 3.765640345655984*^9}, {
  3.765644508650651*^9, 3.765644508651873*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"5f4d786d-ae84-42f8-86f5-3a6c133fd78b"],

Cell[BoxData["78.125`"], "Output",
 CellChangeTimes->{{3.76564033467379*^9, 3.7656403458084173`*^9}, 
   3.765646707782935*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"8960b49e-16bc-4814-b46b-b0ac099612d1"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fmm Orthtree", "Subsection",
 CellChangeTimes->{{3.7660068088179092`*^9, 
  3.766006812185583*^9}},ExpressionUUID->"9a0f0bfa-a901-47f2-b4a9-\
42b3aa68f7dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"treeGeometryData", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<geometry.dat\>\"", ",", "\"\<Table\>\"", ",", 
     RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointsData", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<points.dat\>\"", ",", "\"\<Table\>\"", ",", 
     RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neighbourData", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<neighbours.dat\>\"", ",", "\"\<Table\>\"", ",", 
     RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interactionData", " ", "=", " ", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<interactions.dat\>\"", ",", "\"\<Table\>\"", ",", 
      RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim", " ", "=", "  ", 
   RowBox[{"Length", " ", "@", " ", 
    RowBox[{"treeGeometryData", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"4", ";;"}]}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"quadtreeNodes", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"center", " ", "=", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"4", ";;", 
              RowBox[{"4", "+", "dim", "-", "1"}]}], "]"}], "]"}]}], ",", 
          RowBox[{"box\[LetterSpace]len", " ", "=", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{"diag", " ", "=", " ", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", "dim"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"makeBoxPoints", "[", 
             RowBox[{"center", ",", "box\[LetterSpace]len"}], "]"}], ",", 
            "1"}], "]"}]}], " ", "]"}]}], "]"}], "&"}], "/@", " ", 
     "treeGeometryData"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"height", " ", "=", " ", 
    RowBox[{"Max", " ", "@", " ", 
     RowBox[{"quadtreeNodes", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"quadtreeNodesbyLevel", " ", "=", " ", 
   RowBox[{"GroupBy", "[", 
    RowBox[{"quadtreeNodes", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sourceDataByNode", " ", "=", " ", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
           RowBox[{"dim", "+", "1"}]}], "]"}]}], "&"}], "/@", " ", 
       "pointsData"}], "]"}], " ", "//.", " ", 
     RowBox[{
      RowBox[{"{", "}"}], "\[Rule]", 
      RowBox[{"Sequence", "[", "]"}]}]}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.765306153826641*^9, 3.765306156166518*^9}, {
   3.765306189916923*^9, 3.765306192420001*^9}, {3.765306228443913*^9, 
   3.7653062365296507`*^9}, {3.765310359930539*^9, 3.765310373248488*^9}, {
   3.76531056810246*^9, 3.765310588148979*^9}, {3.765310654651972*^9, 
   3.765310666178987*^9}, {3.76531072093867*^9, 3.765310723858541*^9}, 
   3.7653128064957952`*^9, {3.7653146454122467`*^9, 3.765314659642091*^9}, 
   3.765465209130671*^9, {3.765548501441495*^9, 3.765548508314419*^9}, {
   3.765548588366755*^9, 3.7655485913270483`*^9}, 3.76554954508352*^9, {
   3.765560196170577*^9, 3.765560199703437*^9}, {3.765560351007453*^9, 
   3.765560403451131*^9}, {3.7655605232748213`*^9, 3.765560574863751*^9}, {
   3.765560612183036*^9, 3.765560647398563*^9}, {3.765560686453608*^9, 
   3.7655607024246197`*^9}, {3.7655607864084473`*^9, 3.765560788979247*^9}, {
   3.765560846973298*^9, 3.765560847835854*^9}, {3.765560919266876*^9, 
   3.765561004424477*^9}, {3.7655617295629168`*^9, 3.765561732264578*^9}, {
   3.7655623289450293`*^9, 3.765562333948988*^9}, {3.765644327010954*^9, 
   3.765644391456016*^9}, {3.765644429574974*^9, 3.76564450863934*^9}, {
   3.765644550692878*^9, 3.7656445828027678`*^9}, {3.765644652651855*^9, 
   3.765644665768009*^9}, {3.765645541261139*^9, 3.765645556980432*^9}, {
   3.7660070846480618`*^9, 3.766007089885396*^9}, {3.766007179549994*^9, 
   3.766007204734413*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"381a2eef-c0a4-4ef8-a35a-b48873e757bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pointsDataByNode", " ", "=", " ", 
   RowBox[{"sourceDataByNode", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"1", ";;", "dim"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chargeDataByNode", " ", "=", " ", 
   RowBox[{"sourceDataByNode", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"dim", "+", "1"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.766007117276875*^9, 3.766007171003071*^9}, {
  3.766007207556374*^9, 3.766007208570856*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"b7cc8b64-44b6-490c-875e-2547e9df061a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lpPoints", " ", "=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Values", "[", "pointsDataByNode", "]"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ListPointPlot3D", "[", 
       RowBox[{
        RowBox[{"Values", "[", "pointsDataByNode", "]"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subdivGraphicsFun", "[", "l_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"opts", " ", "=", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
         RowBox[{"Opacity", "[", "0", "]"}]}], "]"}]}], " ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", " ", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"opts", ",", 
           RowBox[{"Dynamic", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Rectangle", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ";;", 
                   RowBox[{"3", "+", "dim", "-", "1"}]}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"3", "+", "dim"}], ";;"}], "]"}], "]"}]}], "]"}], 
              "&"}], "/@", " ", 
             RowBox[{"quadtreeNodesbyLevel", "[", "l", "]"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", " ", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{"opts", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"Cuboid", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ";;", 
                  RowBox[{"3", "+", "dim", "-", "1"}]}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"3", "+", "dim"}], ";;"}], "]"}], "]"}]}], "]"}], 
             "]"}], "&"}], "/@", " ", 
           RowBox[{"quadtreeNodesbyLevel", "[", "l", "]"}]}]}], "}"}], 
        "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interactionGraphicFun", "[", "interactionDataPoint_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"level", " ", "=", " ", 
        RowBox[{"interactionDataPoint", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"box\[LetterSpace]len", " ", "=", " ", 
        RowBox[{"interactionDataPoint", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"center", " ", "=", " ", 
        RowBox[{"interactionDataPoint", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", 
           RowBox[{"4", "+", "dim", "-", "1"}]}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"assocPoints", " ", "=", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"interactionDataPoint", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"4", "+", "dim"}], ";;"}], "]"}], "]"}], ",", "dim"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"srcGraphicsOpts", " ", "=", " ", 
        RowBox[{"Directive", "[", 
         RowBox[{"Purple", ",", 
          RowBox[{"Opacity", "[", ".25", "]"}], ",", 
          RowBox[{"EdgeForm", "[", "Black", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"interactsGraphicsOpts", " ", "=", " ", 
        RowBox[{"Directive", "[", 
         RowBox[{"Orange", ",", 
          RowBox[{"Opacity", "[", "0.1", "]"}], ",", 
          RowBox[{"EdgeForm", "[", "Black", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"GraphicsFun", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", " ", "Graphics", 
          ",", " ", "Graphics3D"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
     ",", 
     RowBox[{"GraphicsFun", "@", " ", 
      RowBox[{"{", 
       RowBox[{"interactsGraphicsOpts", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"makeBox", "[", 
           RowBox[{"makeBoxPoints", "[", 
            RowBox[{"#", ",", "box\[LetterSpace]len"}], "]"}], "]"}], "&"}], "/@",
          " ", "assocPoints"}], ",", "srcGraphicsOpts", ",", 
        RowBox[{"makeBox", "[", 
         RowBox[{"makeBoxPoints", "[", 
          RowBox[{"center", ",", " ", "box\[LetterSpace]len"}], "]"}], 
         "]"}]}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", 
     StyleBox["[", "Input"], 
     StyleBox[
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"lpPoints", ",", "\[IndentingNewLine]", 
        RowBox[{"subdivGraphicsFun", "[", "l", "]"}]}], "\[IndentingNewLine]",
        "}"}], "Input"], 
     StyleBox["]", "Input"]}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "0", ",", "height", ",", "1"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"subdivGraphicsFun", "[", 
          RowBox[{"interactionData", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"interactionGraphicFun", " ", "@", " ", 
          RowBox[{"neighbourData", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"subdivGraphicsFun", "[", 
          RowBox[{"interactionData", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"interactionGraphicFun", " ", "@", " ", 
          RowBox[{"interactionData", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "neighbourData", "]"}], ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.765312882589204*^9, 3.765313035570677*^9}, {
   3.765313266259618*^9, 3.765313266362226*^9}, {3.765313298028767*^9, 
   3.7653133097664537`*^9}, {3.765313823102285*^9, 3.765313832375024*^9}, {
   3.76531427666072*^9, 3.765314276798758*^9}, {3.7653143284714317`*^9, 
   3.765314328612067*^9}, {3.76546513034007*^9, 3.7654651656248503`*^9}, {
   3.7654654073839817`*^9, 3.7654654556267223`*^9}, {3.7655475570559177`*^9, 
   3.765547557109421*^9}, {3.765547590511417*^9, 3.7655475906691217`*^9}, {
   3.765547721867256*^9, 3.7655477230988083`*^9}, {3.765547785683567*^9, 
   3.7655477857288*^9}, {3.765548118557727*^9, 3.765548118697876*^9}, {
   3.765549647886285*^9, 3.765549651355523*^9}, {3.7655498440503902`*^9, 
   3.7655498447836742`*^9}, {3.7655504806897287`*^9, 3.765550483132427*^9}, {
   3.76555102921898*^9, 3.765551030236555*^9}, {3.765551447802456*^9, 
   3.765551469368621*^9}, {3.765551635278389*^9, 3.7655516360141287`*^9}, {
   3.765551669570581*^9, 3.765551675450844*^9}, {3.765551722780493*^9, 
   3.765551732269063*^9}, {3.765561215773588*^9, 3.7655613337763853`*^9}, {
   3.765561367577497*^9, 3.7655613734477253`*^9}, {3.765561487817129*^9, 
   3.765561488896133*^9}, {3.7655615611835957`*^9, 3.765561605827853*^9}, {
   3.765561737250759*^9, 3.765561786175887*^9}, {3.765562348743559*^9, 
   3.7655623511428833`*^9}, {3.765644508643427*^9, 3.765644508645266*^9}, {
   3.765644672161911*^9, 3.7656447363990517`*^9}, {3.7656466476249123`*^9, 
   3.765646682743989*^9}, {3.765646780424035*^9, 3.765646783021538*^9}, {
   3.765647314606834*^9, 3.765647314906753*^9}, {3.76565243861965*^9, 
   3.765652438847023*^9}, 3.7656525219681664`*^9, {3.765652587470716*^9, 
   3.7656526015938253`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"ce0d9120-fc7d-4084-ad93-46c3807e53de"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`l$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`l$$], 0, 3, 1}}, Typeset`size$$ = {295., {4., 10.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`l$19275$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`l$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`l$$, $CellContext`l$19275$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[{$CellContext`lpPoints, 
         $CellContext`subdivGraphicsFun[$CellContext`l$$]}], 
      "Specifications" :> {{$CellContext`l$$, 0, 3, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{338., {48., 53.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.765312911092852*^9, 3.765313036023178*^9}, 
   3.765313266627288*^9, 3.7653138328675413`*^9, 3.765314127652234*^9, 
   3.765314215037654*^9, 3.7653142773467417`*^9, 3.7653143289895906`*^9, 
   3.76531445141324*^9, {3.7653146615149097`*^9, 3.7653146699703913`*^9}, {
   3.765361557661113*^9, 3.7653615753215218`*^9}, {3.7654651085084047`*^9, 
   3.765465166340571*^9}, {3.765465398818254*^9, 3.7654654156189213`*^9}, 
   3.765465456150857*^9, {3.7654864620707407`*^9, 3.765486467329773*^9}, {
   3.765547258287045*^9, 3.7655472640776443`*^9}, {3.765547505090053*^9, 
   3.765547591612275*^9}, {3.765547724103897*^9, 3.765547734203333*^9}, {
   3.76554778656467*^9, 3.765547810608712*^9}, 3.765548076732621*^9, 
   3.7655481195036182`*^9, 3.765548301244248*^9, 3.7655487697494993`*^9, 
   3.765548876254799*^9, 3.76554956385641*^9, 3.765549652059251*^9, 
   3.765549845393401*^9, 3.765550483880498*^9, 3.765550657098749*^9, 
   3.76555086621697*^9, 3.7655510307844887`*^9, 3.765551471053134*^9, 
   3.7655516761489897`*^9, {3.7655517330808687`*^9, 3.765551745641128*^9}, {
   3.7655543890548277`*^9, 3.7655544067150784`*^9}, 3.765561289566967*^9, 
   3.765561335588121*^9, 3.765561373825232*^9, {3.765561580100933*^9, 
   3.765561606264292*^9}, 3.7655616460335827`*^9, {3.7655617425220633`*^9, 
   3.765561786838826*^9}, 3.76556183889212*^9, {3.765562338962289*^9, 
   3.7655623554353848`*^9}, {3.765562404090213*^9, 3.765562414607958*^9}, 
   3.765562462464918*^9, {3.7656402968818398`*^9, 3.765640306864003*^9}, {
   3.765640392220315*^9, 3.765640404346279*^9}, {3.765644484660678*^9, 
   3.7656445146289663`*^9}, 3.765644694574778*^9, 3.765645560706962*^9, 
   3.7656466844292183`*^9, 3.7656467835188923`*^9, 3.765647315586472*^9, 
   3.7656493988339453`*^9, {3.765652440900283*^9, 3.765652470130382*^9}, 
   3.765652522718858*^9, {3.7656525883434*^9, 3.76565260246799*^9}, {
   3.7659751440746727`*^9, 3.7659751481817207`*^9}, {3.765994471354288*^9, 
   3.765994477168778*^9}, 3.766007212390317*^9, 3.76600880195086*^9, {
   3.766053857185205*^9, 3.766053861840616*^9}, 3.7662512725817966`*^9, 
   3.7662524189157267`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"da1f57b2-f175-4dc9-a9c0-d46746261ec5"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 85, 1}}, Typeset`size$$ = {324., {83., 86.}},
     Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`i$19299$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$19299$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> GraphicsRow[{
         Show[{
           $CellContext`subdivGraphicsFun[
            Part[$CellContext`interactionData, $CellContext`i$$, 2]], 
           $CellContext`interactionGraphicFun[
            Part[$CellContext`neighbourData, $CellContext`i$$]]}], 
         Show[{
           $CellContext`subdivGraphicsFun[
            Part[$CellContext`interactionData, $CellContext`i$$, 2]], 
           $CellContext`interactionGraphicFun[
            Part[$CellContext`interactionData, $CellContext`i$$]]}]}], 
      "Specifications" :> {{$CellContext`i$$, 1, 85, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{367., {124., 129.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.765312911092852*^9, 3.765313036023178*^9}, 
   3.765313266627288*^9, 3.7653138328675413`*^9, 3.765314127652234*^9, 
   3.765314215037654*^9, 3.7653142773467417`*^9, 3.7653143289895906`*^9, 
   3.76531445141324*^9, {3.7653146615149097`*^9, 3.7653146699703913`*^9}, {
   3.765361557661113*^9, 3.7653615753215218`*^9}, {3.7654651085084047`*^9, 
   3.765465166340571*^9}, {3.765465398818254*^9, 3.7654654156189213`*^9}, 
   3.765465456150857*^9, {3.7654864620707407`*^9, 3.765486467329773*^9}, {
   3.765547258287045*^9, 3.7655472640776443`*^9}, {3.765547505090053*^9, 
   3.765547591612275*^9}, {3.765547724103897*^9, 3.765547734203333*^9}, {
   3.76554778656467*^9, 3.765547810608712*^9}, 3.765548076732621*^9, 
   3.7655481195036182`*^9, 3.765548301244248*^9, 3.7655487697494993`*^9, 
   3.765548876254799*^9, 3.76554956385641*^9, 3.765549652059251*^9, 
   3.765549845393401*^9, 3.765550483880498*^9, 3.765550657098749*^9, 
   3.76555086621697*^9, 3.7655510307844887`*^9, 3.765551471053134*^9, 
   3.7655516761489897`*^9, {3.7655517330808687`*^9, 3.765551745641128*^9}, {
   3.7655543890548277`*^9, 3.7655544067150784`*^9}, 3.765561289566967*^9, 
   3.765561335588121*^9, 3.765561373825232*^9, {3.765561580100933*^9, 
   3.765561606264292*^9}, 3.7655616460335827`*^9, {3.7655617425220633`*^9, 
   3.765561786838826*^9}, 3.76556183889212*^9, {3.765562338962289*^9, 
   3.7655623554353848`*^9}, {3.765562404090213*^9, 3.765562414607958*^9}, 
   3.765562462464918*^9, {3.7656402968818398`*^9, 3.765640306864003*^9}, {
   3.765640392220315*^9, 3.765640404346279*^9}, {3.765644484660678*^9, 
   3.7656445146289663`*^9}, 3.765644694574778*^9, 3.765645560706962*^9, 
   3.7656466844292183`*^9, 3.7656467835188923`*^9, 3.765647315586472*^9, 
   3.7656493988339453`*^9, {3.765652440900283*^9, 3.765652470130382*^9}, 
   3.765652522718858*^9, {3.7656525883434*^9, 3.76565260246799*^9}, {
   3.7659751440746727`*^9, 3.7659751481817207`*^9}, {3.765994471354288*^9, 
   3.765994477168778*^9}, 3.766007212390317*^9, 3.76600880195086*^9, {
   3.766053857185205*^9, 3.766053861840616*^9}, 3.7662512725817966`*^9, 
   3.766252419181766*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"46dcfc45-b61e-485a-adc9-fc765b41bba6"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"lpPoints\\\", \\\",\\\", RowBox[{\\\"subdivGraphicsFun\\\", \\\"[\
\\\", \\\"0\\\", \\\"]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]\\).\"",2,1,1,
   21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254244508541*^9},
 CellLabel->"",ExpressionUUID->"942c60c0-e8cd-44a9-932c-df3e530f4abf"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,1,2,
   21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254244636751*^9},
 CellLabel->"",ExpressionUUID->"5eeafcfd-2599-4cba-839b-9d7b806b9aeb"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"neighbourData\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,1,3,21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254244657776*^9},
 CellLabel->"",ExpressionUUID->"8c58653c-ba84-40bb-ac62-05d07433667d"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"subdivGraphicsFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"interactionGraphicFun\\\", \\\"[\\\", RowBox[{\\\"neighbourData\\\
\", \\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]\\).\"",2,1,4,21406062776275276906,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254244705392*^9},
 CellLabel->"",ExpressionUUID->"0ba0d58d-81d4-4b41-b775-d182e00c21de"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,1,5,
   21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254244758472*^9},
 CellLabel->"",ExpressionUUID->"af1045d8-ecbb-47f3-9d5d-8e1859cec69e"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,1,6,21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254244810034*^9},
 CellLabel->"",ExpressionUUID->"12ddcc10-e45b-4661-904f-bed3fb0fac86"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"subdivGraphicsFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"interactionGraphicFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\
\\\", \\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \
\\\"\[RightDoubleBracket]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \
\\\"]\\\"}]\\).\"",2,1,7,21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254244864908*^9},
 CellLabel->"",ExpressionUUID->"89783744-16c1-4c07-8e29-be99fa453eef"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,1,8,
   21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254252840107*^9},
 CellLabel->"",ExpressionUUID->"8b4b7d93-01a9-4512-ac6e-81183f0ae8e5"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"neighbourData\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,1,9,21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254252847075*^9},
 CellLabel->"",ExpressionUUID->"6631198a-cc5f-4232-bc8b-2714cf8b6ac7"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"subdivGraphicsFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"interactionGraphicFun\\\", \\\"[\\\", RowBox[{\\\"neighbourData\\\
\", \\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]\\).\"",2,1,10,21406062776275276906,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.76625425285308*^9},
 CellLabel->"",ExpressionUUID->"853f45cd-2ea7-4a4d-98c7-bf5fc7d00b8b"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,1,11,
   21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.76625425285824*^9},
 CellLabel->"",ExpressionUUID->"f69954a8-254d-4e05-a148-8f87c1b4a8be"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,1,12,21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254252915147*^9},
 CellLabel->"",ExpressionUUID->"6b5b9f70-bc5e-4374-af3b-ff65fd81c344"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"subdivGraphicsFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"interactionGraphicFun\\\", \\\"[\\\", RowBox[{\\\"interactionData\
\\\", \\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \
\\\"\[RightDoubleBracket]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \
\\\"]\\\"}]\\).\"",2,1,13,21406062776275276906,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766254252969502*^9},
 CellLabel->"",ExpressionUUID->"df6738f6-551b-4dfa-8fce-8ac39e4f760b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multipole Expansion test: ", "Subsubsection",
 CellChangeTimes->{{3.766252441575595*^9, 
  3.766252446126815*^9}},ExpressionUUID->"3409cc93-2903-4e3a-a853-\
bf71e6405903"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allPoints", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Values", "[", "pointsDataByNode", "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allCharges", " ", "=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Values", "[", "chargeDataByNode", "]"}], ",", "1"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"potFun", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], ",", "q_", ",", 
    RowBox[{"{", 
     RowBox[{"x0_", ",", "y0_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "q"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"r", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "-", 
      RowBox[{"{", 
       RowBox[{"x0", ",", "y0"}], "}"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"forceFun", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], ",", "q_", ",", 
    RowBox[{"{", 
     RowBox[{"x0_", ",", "y0_"}], "}"}]}], "]"}], ":=", " ", 
  FractionBox[
   RowBox[{
    RowBox[{"q", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]}], "-", 
    RowBox[{"{", 
     RowBox[{"x0", ",", "y0"}], "}"}]}], 
   SuperscriptBox[
    RowBox[{"r", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "-", 
      RowBox[{"{", 
       RowBox[{"x0", ",", "y0"}], "}"}]}], "]"}], "2"]]}]}], "Input",
 CellChangeTimes->{{3.766252470926948*^9, 3.766252472351109*^9}, {
  3.766252511294153*^9, 3.7662525257740717`*^9}, {3.766252569399802*^9, 
  3.766252584746767*^9}, {3.766252618070072*^9, 3.766252627966812*^9}, {
  3.766252737187602*^9, 3.766252809987296*^9}, {3.7662531170432796`*^9, 
  3.766253161774804*^9}},ExpressionUUID->"7093784b-819a-4678-b70e-\
40cbc05efdf4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"potVal", " ", "=", " ", 
  RowBox[{"ParallelSum", "[", 
   RowBox[{
    RowBox[{"potFun", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"96", ",", "96"}], "}"}], ",", 
      RowBox[{"allCharges", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"allPoints", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"forceVal", " ", "=", " ", 
  RowBox[{"ParallelSum", "[", 
   RowBox[{
    RowBox[{"forceFun", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"96", ",", "96"}], "}"}], ",", 
      RowBox[{"allCharges", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"allPoints", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.7662526307703543`*^9, 3.76625266445944*^9}, {
  3.7662527027307177`*^9, 3.766252728555881*^9}, {3.766252840104319*^9, 
  3.766252860408058*^9}, {3.766252934818679*^9, 3.76625293768637*^9}, {
  3.766254252813581*^9, 
  3.766254259742826*^9}},ExpressionUUID->"dd3262c5-ec4a-49f9-ab48-\
f1034dfb6843"],

Cell[BoxData["33.598178279309735`"], "Output",
 CellChangeTimes->{3.766252863897469*^9, 3.766252937994186*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"8ca51f31-9b21-499c-8a87-7961ccf32d86"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Misc", "Subsubsection",
 CellChangeTimes->{{3.766252437391306*^9, 
  3.766252437695313*^9}},ExpressionUUID->"448ab90d-fff6-4fcc-a7a4-\
ab5782fe6d9e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", " ", "@", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", " ", 
    RowBox[{"Values", "[", "pointsDataByNode", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nLeaves", " ", "=", " ", 
   RowBox[{"Length", " ", "@", " ", "pointsData"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"avgNPerLeaf", " ", "=", " ", 
  RowBox[{
   RowBox[{"n", "/", "nLeaves"}], " ", "//", "N"}]}]}], "Input",
 CellChangeTimes->{{3.765551787041687*^9, 3.765551890652936*^9}, {
  3.765561623404464*^9, 3.765561627787978*^9}, {3.765561724289393*^9, 
  3.7655617257193613`*^9}, {3.765640334375659*^9, 3.765640345655984*^9}, {
  3.765644508650651*^9, 3.765644508651873*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"70dcc345-4201-4734-b2ab-cb2f7ebdf9ed"],

Cell[BoxData["78.125`"], "Output",
 CellChangeTimes->{{3.76564033467379*^9, 3.7656403458084173`*^9}, 
   3.765646707782935*^9, 3.766173034373454*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"b2fa5d80-9b6c-4ca9-9d03-d1b4f9d28064"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"U", "[", 
   RowBox[{"z_", ",", 
    RowBox[{"z0_:", "0"}]}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"Log", "[", 
    RowBox[{"z", "-", "z0"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.766234115565585*^9, 3.766234132498336*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"70502c91-1684-4103-91b3-5aa1748268b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"U", "[", 
      RowBox[{"z", ",", "z0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "\[Infinity]", ",", "5"}], "}"}]}], "]"}], "]"}], "/.",
   " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"z0", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"z0", "-", "p"}], ")"}]}], ",", 
    RowBox[{"z", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"z", "-", "p"}], ")"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7662341697855663`*^9, 3.766234196745687*^9}, {
  3.76623465997619*^9, 3.766234679488223*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"a1e68f80-84e3-4e57-b8c3-86e4ca62bffc"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"-", "p"}], "+", "z0"}], 
   RowBox[{
    RowBox[{"-", "p"}], "+", "z"}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "p"}], "+", "z0"}], ")"}], "2"], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "p"}], "+", "z"}], ")"}], "2"]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "p"}], "+", "z0"}], ")"}], "3"], 
   RowBox[{"3", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "p"}], "+", "z"}], ")"}], "3"]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "p"}], "+", "z0"}], ")"}], "4"], 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "p"}], "+", "z"}], ")"}], "4"]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "p"}], "+", "z0"}], ")"}], "5"], 
   RowBox[{"5", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "p"}], "+", "z"}], ")"}], "5"]}]], "-", 
  RowBox[{"Log", "[", 
   RowBox[{
    RowBox[{"-", "p"}], "+", "z"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.7662341969897833`*^9, {3.7662346705663557`*^9, 3.766234679786785*^9}},
 CellLabel->"Out[36]=",ExpressionUUID->"3c9b91dc-260d-4d5f-ab41-2cd16f0bd424"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.766238855303533*^9, 
  3.7662388603201313`*^9}},ExpressionUUID->"97acbc40-d533-4ca6-8828-\
0a62d03d3606"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"Grad", "[", 
   RowBox[{
    RowBox[{"q", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"r", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{"x0", ",", "y0"}], "}"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7662388879590807`*^9, 3.766238946702807*^9}, 
   3.7662400888260937`*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"1beb41e8-b21a-4df5-9b14-adbec7b81dc2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"q", " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", "x0"}], ")"}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "-", "x0"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y", "-", "y0"}], ")"}], "2"]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"q", " ", 
      RowBox[{"(", 
       RowBox[{"y", "-", "y0"}], ")"}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "-", "x0"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y", "-", "y0"}], ")"}], "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7662389302046547`*^9, 3.76623894705275*^9}, 
   3.766240089017796*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"09fdb3ed-79fc-463b-a77a-2922dde7d1cf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{960, 498},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Graphics", All], FontFamily -> "CMU Serif", FontSize -> 10, 
    FontColor -> GrayLevel[0]]}, Visible -> False, FrontEndVersion -> 
  "12.0 for Linux x86 (64-bit) (April 8, 2019)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 276, 3, 90, "Title",ExpressionUUID->"20b3e9fa-13ef-437a-8ffb-39c21866f0df"],
Cell[859, 27, 2384, 60, 304, "Input",ExpressionUUID->"a297ad90-e482-4d8d-ac2f-afc759f162cc",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3268, 91, 162, 3, 50, "Subsection",ExpressionUUID->"a0a974cb-ad02-4734-9d09-73199af7141c"],
Cell[3433, 96, 5085, 121, 316, "Input",ExpressionUUID->"ead56676-13ad-4377-a2bc-d4bc6a788c08"],
Cell[CellGroupData[{
Cell[8543, 221, 8688, 201, 690, "Input",ExpressionUUID->"d3a5136f-f884-468d-a6ea-0fda3d884643"],
Cell[17234, 424, 3654, 61, 119, "Output",ExpressionUUID->"75bf61fc-35d7-4fed-af2c-f5a1bc1acab2"],
Cell[20891, 487, 4078, 70, 271, "Output",ExpressionUUID->"d3f1e018-0dc6-440c-a444-4541a98421e1"],
Cell[24972, 559, 497, 10, 22, "Message",ExpressionUUID->"c65c59ac-3357-44f8-a1e2-6b42c6f75069"],
Cell[25472, 571, 456, 9, 22, "Message",ExpressionUUID->"2bd87da4-1ffb-405d-b1af-0e254ba2774e"],
Cell[25931, 582, 420, 8, 22, "Message",ExpressionUUID->"25c41130-3c14-4675-8c58-ed7b1e1923c9"],
Cell[26354, 592, 783, 14, 22, "Message",ExpressionUUID->"8d763562-3464-4bc3-a528-422b9763ea09"],
Cell[27140, 608, 456, 9, 22, "Message",ExpressionUUID->"dd3cb6f3-1947-49a0-907e-ce089a3e119d"],
Cell[27599, 619, 409, 8, 22, "Message",ExpressionUUID->"fdb8e406-dce0-4f5b-9add-84fb1f40f622"],
Cell[28011, 629, 785, 14, 22, "Message",ExpressionUUID->"6d5aeeac-f13a-44b0-9d0f-faeb80c48d90"],
Cell[28799, 645, 456, 9, 22, "Message",ExpressionUUID->"d97e07f9-f735-4a02-93c3-aeb3ec985580"],
Cell[29258, 656, 418, 8, 22, "Message",ExpressionUUID->"1a00d945-aa3f-4be4-9404-405dbacfea2c"],
Cell[29679, 666, 784, 14, 22, "Message",ExpressionUUID->"5bdf764b-f385-4852-b778-beb0f1cc69bc"],
Cell[30466, 682, 457, 9, 22, "Message",ExpressionUUID->"d19e8a11-3692-4dae-a7fb-4903ce061f76"],
Cell[30926, 693, 410, 8, 22, "Message",ExpressionUUID->"bd92b5ec-34b5-414c-9fed-cad7c14571c3"],
Cell[31339, 703, 786, 14, 22, "Message",ExpressionUUID->"c4f32a25-cbfc-4123-adff-b19c454e6fa6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32162, 722, 892, 21, 74, "Input",ExpressionUUID->"5f4d786d-ae84-42f8-86f5-3a6c133fd78b"],
Cell[33057, 745, 206, 3, 33, "Output",ExpressionUUID->"8960b49e-16bc-4814-b46b-b0ac099612d1"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[33312, 754, 162, 3, 36, "Subsection",ExpressionUUID->"9a0f0bfa-a901-47f2-b4a9-42b3aa68f7dc"],
Cell[33477, 759, 5249, 125, 316, "Input",ExpressionUUID->"381a2eef-c0a4-4ef8-a35a-b48873e757bb"],
Cell[38729, 886, 657, 16, 52, "Input",ExpressionUUID->"b7cc8b64-44b6-490c-875e-2547e9df061a"],
Cell[CellGroupData[{
Cell[39411, 906, 8688, 201, 690, "Input",ExpressionUUID->"ce0d9120-fc7d-4084-ad93-46c3807e53de"],
Cell[48102, 1109, 3801, 63, 119, "Output",ExpressionUUID->"da1f57b2-f175-4dc9-a9c0-d46746261ec5"],
Cell[51906, 1174, 4220, 72, 271, "Output",ExpressionUUID->"46dcfc45-b61e-485a-adc9-fc765b41bba6"],
Cell[56129, 1248, 497, 10, 22, "Message",ExpressionUUID->"942c60c0-e8cd-44a9-932c-df3e530f4abf"],
Cell[56629, 1260, 455, 9, 22, "Message",ExpressionUUID->"5eeafcfd-2599-4cba-839b-9d7b806b9aeb"],
Cell[57087, 1271, 417, 8, 22, "Message",ExpressionUUID->"8c58653c-ba84-40bb-ac62-05d07433667d"],
Cell[57507, 1281, 783, 14, 22, "Message",ExpressionUUID->"0ba0d58d-81d4-4b41-b775-d182e00c21de"],
Cell[58293, 1297, 455, 9, 22, "Message",ExpressionUUID->"af1045d8-ecbb-47f3-9d5d-8e1859cec69e"],
Cell[58751, 1308, 407, 8, 22, "Message",ExpressionUUID->"12ddcc10-e45b-4661-904f-bed3fb0fac86"],
Cell[59161, 1318, 783, 14, 22, "Message",ExpressionUUID->"89783744-16c1-4c07-8e29-be99fa453eef"],
Cell[59947, 1334, 455, 9, 22, "Message",ExpressionUUID->"8b4b7d93-01a9-4512-ac6e-81183f0ae8e5"],
Cell[60405, 1345, 417, 8, 22, "Message",ExpressionUUID->"6631198a-cc5f-4232-bc8b-2714cf8b6ac7"],
Cell[60825, 1355, 783, 14, 22, "Message",ExpressionUUID->"853f45cd-2ea7-4a4d-98c7-bf5fc7d00b8b"],
Cell[61611, 1371, 455, 9, 22, "Message",ExpressionUUID->"f69954a8-254d-4e05-a148-8f87c1b4a8be"],
Cell[62069, 1382, 408, 8, 22, "Message",ExpressionUUID->"6b5b9f70-bc5e-4374-af3b-ff65fd81c344"],
Cell[62480, 1392, 784, 14, 22, "Message",ExpressionUUID->"df6738f6-551b-4dfa-8fce-8ac39e4f760b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63301, 1411, 177, 3, 41, "Subsubsection",ExpressionUUID->"3409cc93-2903-4e3a-a853-bf71e6405903"],
Cell[63481, 1416, 1888, 57, 141, "Input",ExpressionUUID->"7093784b-819a-4678-b70e-40cbc05efdf4"],
Cell[CellGroupData[{
Cell[65394, 1477, 1328, 36, 52, "Input",ExpressionUUID->"dd3262c5-ec4a-49f9-ab48-f1034dfb6843"],
Cell[66725, 1515, 193, 3, 33, "Output",ExpressionUUID->"8ca51f31-9b21-499c-8a87-7961ccf32d86"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66967, 1524, 155, 3, 41, "Subsubsection",ExpressionUUID->"448ab90d-fff6-4fcc-a7a4-ab5782fe6d9e"],
Cell[CellGroupData[{
Cell[67147, 1531, 892, 21, 74, "Input",ExpressionUUID->"70dcc345-4201-4734-b2ab-cb2f7ebdf9ed"],
Cell[68042, 1554, 228, 3, 33, "Output",ExpressionUUID->"b2fa5d80-9b6c-4ca9-9d03-d1b4f9d28064"]
}, Open  ]],
Cell[68285, 1560, 346, 9, 29, "Input",ExpressionUUID->"70502c91-1684-4103-91b3-5aa1748268b2"],
Cell[CellGroupData[{
Cell[68656, 1573, 694, 20, 29, "Input",ExpressionUUID->"a1e68f80-84e3-4e57-b8c3-86e4ca62bffc"],
Cell[69353, 1595, 1432, 52, 59, "Output",ExpressionUUID->"3c9b91dc-260d-4d5f-ab41-2cd16f0bd424"]
}, Open  ]],
Cell[70800, 1650, 154, 3, 29, "Input",ExpressionUUID->"97acbc40-d533-4ca6-8828-0a62d03d3606"],
Cell[CellGroupData[{
Cell[70979, 1657, 563, 16, 29, "Input",ExpressionUUID->"1beb41e8-b21a-4df5-9b14-adbec7b81dc2"],
Cell[71545, 1675, 889, 29, 55, "Output",ExpressionUUID->"09fdb3ed-79fc-463b-a77a-2922dde7d1cf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

